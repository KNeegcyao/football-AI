<template>
  <view class="container">
    <!-- Header Image & Overlay -->
    <view class="header-image-container">
      <image 
        class="header-image" 
        src="https://lh3.googleusercontent.com/aida-public/AB6AXuAwsjDBXPF_ZBUL_MNJrjMqbuEppi7q-YRE5SIrTWkDszyCYpHhZnTo4BIH-Rm0bNhS8QEf4Tj52HstK0eLc6Pew4yjFKFmrCf275HGSCQTWOnLQ1ovhjAr1cusTYseYC3GUoQFm857MTCN0YbH6NGP4KMvWwjKCAV4rTuvE7rznuVX5iiQMrYTXWpVN4IHLgloD594kIBxJRZ5euXJWnOKdCWbxsnL2XWmFLUK_YRJHO4VqwOfsZ2rXV0HQie-d_FKkjbuodaH-zWe" 
        mode="aspectFill"
      ></image>
      <view class="header-overlay"></view>
      
      <!-- Top Navigation Bar -->
      <view class="nav-bar">
        <view class="icon-btn" @click="goBack">
          <u-icon name="arrow-left" color="#fff" size="24"></u-icon>
        </view>
        <view class="nav-actions">
          <view class="icon-btn">
            <u-icon name="search" color="#fff" size="24"></u-icon>
          </view>
          <view class="icon-btn">
            <u-icon name="share" color="#fff" size="24"></u-icon>
          </view>
        </view>
      </view>

      <!-- Topic Title -->
      <view class="topic-info">
        <view class="topic-badge-row">
          <view class="badge">Trending</view>
          <view class="ai-label">
            <u-icon name="star-fill" color="#fff" size="14"></u-icon>
            <text class="ai-text">PitchPulse AI çƒ­é—¨è¯é¢˜</text>
          </view>
        </view>
        <text class="topic-title">#{{ topicTitle }}#</text>
      </view>
    </view>

    <!-- Stats & Description -->
    <view class="content-body">
      <view class="stats-row">
        <view class="stat-card">
          <text class="stat-label">è®¨è®º</text>
          <text class="stat-value">1.2w</text>
        </view>
        <view class="stat-card">
          <text class="stat-label">é˜…è¯»</text>
          <text class="stat-value">450w</text>
        </view>
        <view class="stat-card">
          <text class="stat-label">é¢„æµ‹</text>
          <text class="stat-value highlight">89%</text>
        </view>
      </view>

      <view class="description-box">
        <text class="description-text">
          æ¢…è¥¿ç‡é¢†é˜¿æ ¹å»·å›½å®¶é˜Ÿå¼€å¯2024ä¸­å›½è¡Œï¼Œåœ¨åŒ—äº¬ä¸æ‘©æ´›å“¥é˜Ÿè¿›è¡Œå‹è°Šèµ›ã€‚è¿™æ˜¯çƒç‹èŒä¸šç”Ÿæ¶¯ç¬¬å…«æ¬¡æ¥åˆ°ä¸­å›½ï¼Œå…¨åŸçƒè¿·å…±è¿ç››äº‹ã€‚
        </text>
        <view class="expand-btn">
          <text>æŸ¥çœ‹å®Œæ•´èƒŒæ™¯</text>
          <u-icon name="arrow-down" color="#f20d33" size="12"></u-icon>
        </view>
      </view>
    </view>

    <!-- Feed Tabs -->
    <view class="tabs-header sticky-header">
      <view class="tab-item active">æœ€çƒ­</view>
      <view class="tab-item">æœ€æ–°</view>
      <view class="tab-item">åª’ä½“</view>
    </view>

    <!-- Discussion Feed -->
    <view class="feed-list">
      <!-- Post Card 1 -->
      <view class="post-card">
        <view class="post-header">
          <view class="user-info">
            <view class="avatar-wrapper">
              <image class="avatar" src="https://lh3.googleusercontent.com/aida-public/AB6AXuAz587xyU9hdDY5pWPzvhmpbGa8y3P16Qjy-98NjD1s3dwVMidPBhA4O7vGD1z7cvy0V2InSSjLs1ej2k9hjIdC7Ead4njJCVCAqzH0sqDBt9Z9p52AN6THPv46e86A9NwDGMXpBnQ5G5ZxUwABbItjr0v7Lfh7X02oU0Y4ZYShG2GX57DuGIuPTnh9mAq4C4tfmnUKD0qa8dGnJpgq52cxfrZoRLSEIX0gyZGUH6OGvXbIUR68pyf7LOJPepWObEFlylehjyj3NK06" mode="aspectFill"></image>
            </view>
            <view class="user-meta">
              <view class="name-row">
                <text class="username">é˜¿æ ¹å»·æ­»å¿ å¼ ä¼Ÿ</text>
                <u-icon name="checkmark-circle-fill" color="#f20d33" size="14"></u-icon>
              </view>
              <text class="time">2å°æ—¶å‰ Â· åŒ—äº¬</text>
            </view>
          </view>
          <u-icon name="more-dot-fill" color="rgba(255,255,255,0.4)" size="20"></u-icon>
        </view>
        <text class="post-content">
          æ¢…è¥¿çš„é¦–ç§€å¤ªéœ‡æ’¼äº†ï¼å…¨åœºé½å£°é«˜å‘¼åå·çš„é‚£ä¸€åˆ»ï¼Œæˆ‘ç”šè‡³è§‰å¾—è¿™å°±æ˜¯å·¥ä½“çš„å·…å³°æ—¶åˆ»ã€‚é˜¿æ ¹å»·çš„ä¸­åœºæ§åˆ¶åŠ›ä¾ç„¶æ˜¯é¡¶çº§ã€‚ <text class="hashtag">#æ¢…è¥¿ä¸­å›½è¡Œ#</text>
        </text>
        <view class="media-container">
          <image class="post-image" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCPbX5Nw38MvcbPLK4SryvZ9GOrEGCfo4CaLg9j-oiJiBN3gIhp6kTbitTcuxB1_mk-E5GiYD799QTLvzHlQVd30AmhRJApes4YrDv1x6nl8Bp-7bMw7NA88Kma8Wk-nNNpXi9G7Ci7PPtGd1AzhJcjgKbs-HPmC4dc4bBBW32jUakQ0SY-iLwZ5gChwY5ZappipQJ0ovRQG8mNvetrUoXbqPowrpUXs444lNACOYNTHIkcAmuqhvOl1VJ4chMVmC4HUsavdjx8iX7T" mode="aspectFill"></image>
        </view>
        <view class="post-actions">
          <view class="action-group">
            <view class="action-btn">
              <u-icon name="heart" color="rgba(255,255,255,0.6)" size="20"></u-icon>
              <text class="count">1,245</text>
            </view>
            <view class="action-btn">
              <u-icon name="chat" color="rgba(255,255,255,0.6)" size="20"></u-icon>
              <text class="count">89</text>
            </view>
          </view>
          <view class="action-btn">
            <u-icon name="hourglass" color="rgba(255,255,255,0.6)" size="20"></u-icon>
            <text class="count">AI åˆ†æ</text>
          </view>
        </view>
      </view>

      <!-- Post Card 2 (AI Analysis) -->
      <view class="post-card ai-card">
        <view class="ai-bg-icon">
          <u-icon name="info-circle" color="rgba(255,255,255,0.1)" size="60"></u-icon>
        </view>
        <view class="post-header">
          <view class="user-info">
            <view class="avatar-wrapper ai-avatar">
              <u-icon name="star-fill" color="#fff" size="20"></u-icon>
            </view>
            <view class="user-meta">
              <view class="name-row">
                <text class="username">PitchPulse AI åˆ†æå¸ˆ</text>
                <view class="pro-badge">PRO</view>
              </view>
              <text class="time">æˆ˜æœ¯å®æ—¶åŒæ­¥</text>
            </view>
          </view>
        </view>
        <view class="ai-content-box">
          <text class="ai-title">å®æ—¶çƒ­ç‚¹æ‘˜è¦</text>
          <text class="ai-text">å¤§éƒ¨åˆ†ç”¨æˆ·æ­£åœ¨è®¨è®ºä¸ŠåŠåœºç¬¬32åˆ†é’Ÿæ¢…è¥¿çš„è¿‡äººåŠ¨ä½œã€‚è¯¥åŒºåŸŸç¤¾äº¤è®¨è®ºçƒ­åº¦ä¸Šå‡ 400%ã€‚</text>
        </view>
        <view class="ai-footer">
          <text class="ai-footer-text">AI Insights</text>
          <view class="subscribe-btn">è®¢é˜…åˆ†ææŠ¥</view>
        </view>
      </view>

      <!-- Post Card 3 -->
      <view class="post-card">
        <view class="post-header">
          <view class="user-info">
            <view class="avatar-wrapper">
              <image class="avatar" src="https://lh3.googleusercontent.com/aida-public/AB6AXuAW-tRnOKF1UnPpHhxy2flLtbiO8R0HTwS4FeLc56nZBxXLJNcsc-Bo2LkZVB_ap4G03ZX_jHWsmLN9BDVzvD6I2xxi8-_89Aefzqj3EMb6PWRvo-ysi4ExowK2wTcCG-yqpJbTMq8USzEu0eUos6rPE6UGMrR75P1oyqtX6hu6YbCafpnwyZCaXMH-d2hIxz29kk9n1KYH6glR56zVQ3EvZoFaoDtwsKzMcIQzwWPpWUXDlAepvgvskvu4DnCQ-v-1rzD0_2h6BGEr" mode="aspectFill"></image>
            </view>
            <view class="user-meta">
              <view class="name-row">
                <text class="username">Li_Lili_Baller</text>
              </view>
              <text class="time">5å°æ—¶å‰ Â· æ·±åœ³</text>
            </view>
          </view>
          <u-icon name="more-dot-fill" color="rgba(255,255,255,0.4)" size="20"></u-icon>
        </view>
        <text class="post-content">
          å¤§å®¶è§‰å¾—ä»Šå¤©æ¢…è¥¿è¸¢äº†å¤šå°‘åˆ†é’Ÿï¼Ÿæ„Ÿè§‰èº«ä½“çŠ¶æ€ç»´æŒå¾—çœŸå¥½å•Šã€‚å¸Œæœ›ä¸‹æ¬¡æœ‰æœºä¼šèƒ½çœ‹åˆ°ä»–ä»¬å»å—æ–¹è¸¢ä¸€åœºï¼ ğŸ‡¦ğŸ‡·âš½ï¸
        </text>
        <view class="post-actions">
          <view class="action-group">
            <view class="action-btn">
              <u-icon name="heart" color="rgba(255,255,255,0.6)" size="20"></u-icon>
              <text class="count">342</text>
            </view>
            <view class="action-btn">
              <u-icon name="chat" color="rgba(255,255,255,0.6)" size="20"></u-icon>
              <text class="count">15</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- Floating Action Button -->
    <view class="fab-container">
      <button class="fab-btn">
        <u-icon name="plus" color="#fff" size="20"></u-icon>
        <text class="fab-text">å‚ä¸è®¨è®º</text>
      </button>
    </view>
  </view>
</template>

<script setup>
import { ref, onLoad } from '@dcloudio/uni-app';

const topicTitle = ref('æ¢…è¥¿ä¸­å›½è¡Œ');

const goBack = () => {
  uni.navigateBack();
};

onLoad((options) => {
  if (options.title) {
    topicTitle.value = decodeURIComponent(options.title).replace(/^#|#$/g, '');
  }
});
</script>

<style lang="scss" scoped>
.container {
  min-height: 100vh;
  background-color: #0a0a0a;
  color: #fff;
  padding-bottom: 100rpx;
}

.header-image-container {
  position: relative;
  height: 500rpx;
  width: 100%;
}

.header-image {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}

.header-overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(to bottom, rgba(10,10,10,0.4), rgba(10,10,10,1));
}

.nav-bar {
  position: absolute;
  top: 0; /* Will be adjusted by safe-area-inset-top in logic if needed, but fixed here */
  padding-top: var(--status-bar-height); /* Safe area padding */
  left: 0;
  right: 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-left: 32rpx;
  padding-right: 32rpx;
  height: 88rpx; /* Standard nav height */
  z-index: 20;
}

.icon-btn {
  width: 80rpx;
  height: 80rpx;
  border-radius: 50%;
  background-color: rgba(0, 0, 0, 0.2);
  backdrop-filter: blur(10px);
  display: flex;
  align-items: center;
  justify-content: center;
}

.nav-actions {
  display: flex;
  gap: 16rpx;
}

.topic-info {
  position: absolute;
  bottom: 32rpx;
  left: 32rpx;
  right: 32rpx;
}

.topic-badge-row {
  display: flex;
  align-items: center;
  gap: 16rpx;
  margin-bottom: 8rpx;
}

.badge {
  background-color: #f20d33;
  padding: 4rpx 12rpx;
  border-radius: 8rpx;
  font-size: 20rpx;
  font-weight: bold;
  text-transform: uppercase;
  color: #fff;
}

.ai-label {
  display: flex;
  align-items: center;
  gap: 8rpx;
}

.ai-text {
  font-size: 24rpx;
  color: rgba(255, 255, 255, 0.6);
}

.topic-title {
  font-size: 48rpx;
  font-weight: 900;
  font-style: italic;
  letter-spacing: -1px;
  color: #fff;
}

.content-body {
  padding: 32rpx;
}

.stats-row {
  display: flex;
  gap: 24rpx;
  margin-bottom: 32rpx;
}

.stat-card {
  flex: 1;
  background-color: #1a1a1a;
  border: 1rpx solid rgba(255, 255, 255, 0.05);
  border-radius: 24rpx;
  padding: 24rpx;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.stat-label {
  font-size: 20rpx;
  color: rgba(255, 255, 255, 0.5);
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 2px;
  margin-bottom: 8rpx;
}

.stat-value {
  font-size: 36rpx;
  font-weight: 900;
  color: #fff;
}

.stat-value.highlight {
  color: #f20d33;
}

.description-box {
  background-color: rgba(242, 13, 51, 0.1);
  border-left: 8rpx solid #f20d33;
  padding: 24rpx;
  border-top-right-radius: 16rpx;
  border-bottom-right-radius: 16rpx;
  margin-bottom: 32rpx;
}

.description-text {
  font-size: 28rpx;
  color: rgba(255, 255, 255, 0.9);
  line-height: 1.6;
}

.expand-btn {
  margin-top: 16rpx;
  display: flex;
  align-items: center;
  gap: 8rpx;
  font-size: 24rpx;
  color: #f20d33;
  font-weight: bold;
}

.tabs-header {
  position: sticky;
  top: 0; /* Needs adjustment if header is fixed, but here it flows */
  z-index: 10;
  background-color: rgba(10, 10, 10, 0.8);
  backdrop-filter: blur(20px);
  border-bottom: 1rpx solid rgba(255, 255, 255, 0.05);
  display: flex;
  padding: 0 32rpx;
}

.tab-item {
  padding: 32rpx;
  font-size: 28rpx;
  font-weight: 500;
  color: rgba(255, 255, 255, 0.4);
  position: relative;
}

.tab-item.active {
  color: #fff;
  font-weight: bold;
}

.tab-item.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 32rpx;
  right: 32rpx;
  height: 4rpx;
  background-color: #f20d33;
}

.feed-list {
  padding: 32rpx;
  display: flex;
  flex-direction: column;
  gap: 32rpx;
}

.post-card {
  background-color: #1a1a1a;
  border-radius: 24rpx;
  padding: 32rpx;
  border: 1rpx solid rgba(255, 255, 255, 0.05);
  box-shadow: 0 8rpx 30rpx rgba(0, 0, 0, 0.3);
}

.post-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 24rpx;
}

.user-info {
  display: flex;
  align-items: center;
  gap: 24rpx;
}

.avatar-wrapper {
  width: 80rpx;
  height: 80rpx;
  border-radius: 50%;
  overflow: hidden;
  border: 4rpx solid rgba(242, 13, 51, 0.3);
  background-color: #333;
}

.avatar {
  width: 100%;
  height: 100%;
}

.user-meta {
  display: flex;
  flex-direction: column;
}

.name-row {
  display: flex;
  align-items: center;
  gap: 8rpx;
}

.username {
  font-size: 28rpx;
  font-weight: bold;
  color: #fff;
}

.time {
  font-size: 20rpx;
  color: rgba(255, 255, 255, 0.4);
}

.post-content {
  font-size: 28rpx;
  color: rgba(255, 255, 255, 0.9);
  line-height: 1.5;
  margin-bottom: 24rpx;
  display: block;
}

.hashtag {
  color: #f20d33;
  font-weight: 500;
  margin-left: 8rpx;
}

.media-container {
  border-radius: 16rpx;
  overflow: hidden;
  margin-bottom: 32rpx;
  height: 400rpx;
  background-color: rgba(0, 0, 0, 0.4);
}

.post-image {
  width: 100%;
  height: 100%;
}

.post-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 16rpx;
  border-top: 1rpx solid rgba(255, 255, 255, 0.05);
}

.action-group {
  display: flex;
  gap: 32rpx;
}

.action-btn {
  display: flex;
  align-items: center;
  gap: 12rpx;
}

.count {
  font-size: 24rpx;
  color: rgba(255, 255, 255, 0.6);
}

/* AI Card Styles */
.ai-card {
  position: relative;
  overflow: hidden;
}

.ai-bg-icon {
  position: absolute;
  top: 0;
  right: 0;
  padding: 16rpx;
  opacity: 0.1;
  pointer-events: none;
}

.ai-avatar {
  background-color: #f20d33;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
}

.pro-badge {
  background-color: rgba(242, 13, 51, 0.2);
  color: #f20d33;
  font-size: 16rpx;
  font-weight: 900;
  padding: 2rpx 8rpx;
  border-radius: 4rpx;
}

.ai-content-box {
  background-color: rgba(0, 0, 0, 0.2);
  border-radius: 16rpx;
  padding: 24rpx;
  border: 1rpx solid rgba(242, 13, 51, 0.2);
  margin-bottom: 24rpx;
}

.ai-title {
  font-size: 24rpx;
  font-weight: bold;
  color: #f20d33;
  margin-bottom: 8rpx;
  text-transform: uppercase;
  letter-spacing: 2px;
  display: block;
}

.ai-text {
  font-size: 24rpx;
  color: rgba(255, 255, 255, 0.7);
}

.ai-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.ai-footer-text {
  font-size: 20rpx;
  color: rgba(255, 255, 255, 0.3);
  text-transform: uppercase;
  font-weight: 900;
  font-style: italic;
}

.subscribe-btn {
  font-size: 20rpx;
  background-color: rgba(255, 255, 255, 0.05);
  padding: 8rpx 16rpx;
  border-radius: 999rpx;
  color: rgba(255, 255, 255, 0.6);
}

/* FAB */
.fab-container {
  position: fixed;
  bottom: 48rpx;
  left: 0;
  right: 0;
  display: flex;
  justify-content: center;
  z-index: 50;
  pointer-events: none; /* Container passes clicks */
}

.fab-btn {
  pointer-events: auto;
  background-color: #f20d33;
  color: #fff;
  padding: 0 48rpx;
  height: 96rpx;
  border-radius: 999rpx;
  display: flex;
  align-items: center;
  gap: 16rpx;
  box-shadow: 0 16rpx 60rpx rgba(242, 13, 51, 0.4);
  border: 1rpx solid rgba(255, 255, 255, 0.1);
  /* Reset button default styles */
  margin: 0;
  line-height: 1;
}

.fab-btn:active {
  transform: scale(0.95);
}

.fab-text {
  font-size: 28rpx;
  font-weight: 900;
  letter-spacing: 2px;
}
</style>